<div class="wrapper">
  <mat-toolbar color="primary">
    <button mat-icon-button (click)="isExpanded = !isExpanded" matTooltip="Menu">
      <mat-icon>{{isExpanded ? 'menu_open' : 'menu'}}</mat-icon>
    </button>
    <span class="name">Localess</span>
    <span class="spacer"></span>

    <ng-container *ngIf="selectedSpace; else elseNoSpace">
      <button mat-flat-button [matMenuTriggerFor]="spacesMenu" matTooltip="Select a Space">
        {{selectedSpace.name}}
        <mat-icon iconPositionEnd>arrow_drop_down</mat-icon>
      </button>
      <mat-menu #spacesMenu="matMenu" yPosition="below" xPosition="after">
        <button mat-menu-item *ngFor="let space of spaces" (click)="onSpaceSelection(space)">
         <span [class.fw-semibold]="space.id === selectedSpace.id">
           {{space.name}}
         </span>
        </button>
      </mat-menu>
    </ng-container>

    <ng-template #elseNoSpace>
      <button mat-raised-button color="warn" routerLink="/features/spaces">
        No Spaces. Click here to create one.
      </button>
    </ng-template>


    <span class="spacer"></span>
    <button mat-icon-button  routerLink="/features/me" matTooltip="My Profile">
      <mat-icon>account_circle</mat-icon>
    </button>
    <button mat-icon-button (click)="onLogoutClick()" matTooltip="LogOut">
      <mat-icon>logout</mat-icon>
    </button>
  </mat-toolbar>

  <mat-sidenav-container autosize="true">

    <mat-sidenav mode="side" opened="true" [class.collapsed]="!isExpanded">
      <mat-nav-list>

        <ng-container *ngIf="selectedSpace">
          <ng-container *ngFor="let item of userSideMenu">
            <mat-list-item *ngIf="item.permission | canUserPerform | async" [routerLink]="[item.link]" routerLinkActive="active">
              <mat-icon matListItemIcon [matTooltip]="item.label">{{item.icon}}</mat-icon>
              <div matListItemTitle *ngIf="isExpanded">{{item.label}}</div>
            </mat-list-item>
          </ng-container>
        </ng-container>

        <mat-divider/>
        <div mat-subheader *ngIf="isExpanded">Admin</div>
        <ng-container *ngFor="let item of adminSideMenu">
          <mat-list-item *ngIf="item.permission | canUserPerform | async" [routerLink]="[item.link]" routerLinkActive="active">
            <mat-icon matListItemIcon [matTooltip]="item.label">{{item.icon}}</mat-icon>
            <div matListItemTitle *ngIf="isExpanded">{{item.label}}</div>
          </mat-list-item>
        </ng-container>

        <mat-divider/>
        <div mat-subheader *ngIf="isExpanded">Community and Support</div>
        <mat-list-item *ngFor="let item of communitySideMenu" (click)="openNewTab(item.link)">
          <mat-icon matListItemIcon [matTooltip]="item.label">{{item.icon}}</mat-icon>
          <div matListItemTitle *ngIf="isExpanded">{{item.label}}</div>
        </mat-list-item>

        <mat-divider/>
        <div mat-subheader *ngIf="isExpanded">Version : {{version}}</div>
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content>
      <ng-container *ngIf="isRoleNone">
        Please contact your administrator to grant you access to resources.
      </ng-container>
      <router-outlet></router-outlet>
    </mat-sidenav-content>

  </mat-sidenav-container>
</div>
